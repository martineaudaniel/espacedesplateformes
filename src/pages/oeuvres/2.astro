---
// src/pages/works/artwork1.astro
import DefaultLayout from '../../layouts/DefaultLayout.astro'
import { Pagination } from 'accessible-astro-components'
import PhotoSwipeGallery from '../../components/PhotoSwipeGallery.astro'

// Get current page number from the filename (e.g., "1" for 1.astro)
const currentPage = parseInt(Astro.params.pageNumber || '2', 10)
const totalPages = 15 // Set this to the total number of pages you have

// Pagination URLs
const firstPage = currentPage > 1 ? '/oeuvres/1' : null
const previousPage = currentPage > 1 ? `/oeuvres/${currentPage - 1}` : null
const nextPage = currentPage < totalPages ? `/oeuvres/${currentPage + 1}` : null
const lastPage = currentPage < totalPages ? `/oeuvres/${totalPages}` : null

const artwork = {
  title: '',
  subtitle: '',
  description: `Commissariat de l’exposition
L’espace des plateformes

Commissariat général 

Christine Bernier, Marta Boni, Zaira Zarza
Professeures, Département d’histoire de l’art et d’études cinématographiques 

Équipe

Chercheurs, chercheuses, projet Plateformes et usages. Cinéma, télévision, jeu vidéo, création numérique : Marta Boni, Christine Bernier, Zaira Zarza, Joyce Cimper (UdeM), Barbara Laborde, Guillaume Soulez, Vincent Bilem, Florian Body, Joa Neves (Sorbonne Nouvelle – Paris 3). 

Équipe étudiante

Rédaction de textes : Joyce Cimper, Kai Sen Trieu, Mathieu Simard

Modélisation 3D (logiciel SketchUp) et identité visuelle : Renée Filbey, Agatha Lambert

Remerciements

LUDOV
Faculté de l’aménagement, Université de Montréal

Soutien financier

Conseil de recherches en sciences humaines (CRSH), Programme Connexion 
Carrefour des arts et des sciences
CRIHN
Laboratoire CinéMédias
Labo Télé

Commissariat : Christine Bernier, Marta Boni, Zaira Zarza 

Artistes 
Anastasia Bourlakova 
Amanda Gutiérrez 
Tara Karmous 
Darién Sánchez

Youtubeuses et youtubeurs
Adri’s Ambience
Ambiance Magic
Divine Subliminals 
Gibi ASMR
Jimち ASMR
L’ermite des songes

Chercheuses et chercheurs exposants
Marie-Caroline Neuvillers et Gaëtan Rivière
Katharina Niemeyer et Christine Thoër

`,
  images: ['/assets/img/thumbnails/1.jpg', '/assets/img/thumbnails/2.jpg', '/assets/img/thumbnails/3.jpg'],
}
---

<DefaultLayout title={artwork.title}>
  <section class="my-16">
    <div class="container mx-auto flex gap-8">
      <!-- Left Half: Text Content -->
      <div class="flex-1 p-8">
        <div>
          <h1 class="mb-4 text-center text-4xl font-bold">{artwork.title}</h1>
          <h3 class="mb-4 text-center text-2xl font-semibold text-gray-400">{artwork.subtitle}</h3>
          <p class="whitespace-pre-wrap text-center text-xl">{artwork.description}</p>
        </div>
      </div>

      <!-- Right Half: Image Gallery (PhotoSwipe Gallery) -->
      <div class="flex-1 p-8">
        <PhotoSwipeGallery images={artwork.images} />
      </div>
    </div>
  </section>

  <!-- Pagination -->
  <div class="mt-12 grid place-content-center">
    <Pagination
      firstPage={firstPage}
      previousPage={previousPage}
      nextPage={nextPage}
      lastPage={lastPage}
      currentPage={currentPage}
      totalPages={totalPages}
    />
  </div>

  <!-- Initialize PhotoSwipe -->
  <script>
    import PhotoSwipeLightbox from 'photoswipe/lightbox'
    import 'photoswipe/style.css'

    // Function to set image dimensions dynamically
    function setImageDimensions() {
      const galleryItems = document.querySelectorAll('#photoswipe-gallery .gallery-item')
      galleryItems.forEach((item) => {
        const img = item.querySelector('img')
        const image = new Image()
        image.src = img.src
        image.onload = () => {
          item.setAttribute('data-pswp-width', image.width)
          item.setAttribute('data-pswp-height', image.height)
        }
      })
    }

    document.addEventListener('DOMContentLoaded', () => {
      // Set the image dimensions before initializing PhotoSwipe
      setImageDimensions()

      const lightbox = new PhotoSwipeLightbox({
        gallery: '#photoswipe-gallery',
        children: 'a',
        pswpModule: () => import('photoswipe'),
      })
      lightbox.init()
    })
  </script>
</DefaultLayout>
